<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:7,&quot;tests&quot;:26,&quot;passes&quot;:26,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2019-05-15T02:05:55.525Z&quot;,&quot;end&quot;:&quot;2019-05-15T02:06:08.688Z&quot;,&quot;duration&quot;:13163,&quot;testsRegistered&quot;:26,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;2b17c6bb-819d-4cc4-9d18-80d2e0935118&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9e3a2e43-deaa-4352-b8e8-26a3f09a89b3&quot;,&quot;title&quot;:&quot;3、告警接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_alarms.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_alarms.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return a 500 response&quot;,&quot;fullTitle&quot;:&quot;3、告警接口测试 should return a 500 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:233,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`rules/alarms/${util.unitTestParams.deviceIdError}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(500, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2eacc306-aeda-4428-ba21-e1bf7336f24e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;POST should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;3、告警接口测试 POST should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:871,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.post(`rules/alarms/${util.unitTestParams.deviceId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .send([\n        {\n            \&quot;Key\&quot;: \&quot;温度\&quot;,\n            \&quot;IndeterminateRules\&quot;: {\n                \&quot;min\&quot;: \&quot;10\&quot;,\n                \&quot;max\&quot;: \&quot;20\&quot;\n            },\n            \&quot;WarningRules\&quot;: {\n                \&quot;min\&quot;: \&quot;30\&quot;,\n                \&quot;max\&quot;: \&quot;40\&quot;\n            }\n        }\n    ])\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;931b4746-c341-4bcb-8060-5d22f1141b17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET  should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;3、告警接口测试 GET  should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:428,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`rules/alarms/${util.unitTestParams.deviceId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    //.expect(200, done);\n    .end(function (err, resp) {\n        done();\n        var Key = resp.body[0].Key;\n        var IndeterminateRules = resp.body[0].IndeterminateRules;\n        var WarningRules = resp.body[0].WarningRules;\n        //console.info(IndeterminateRules);\n        util.expect(Key).to.be.equal(&#x27;温度&#x27;);\n        util.expect(IndeterminateRules.min).to.be.equal(&#x27;10&#x27;);\n        util.expect(IndeterminateRules.max).to.be.equal(&#x27;20&#x27;);\n        util.expect(WarningRules.min).to.be.equal(&#x27;30&#x27;);\n        util.expect(WarningRules.max).to.be.equal(&#x27;40&#x27;);\n    })&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1d240302-7d62-4dc2-bd8b-9cb47964ba5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2eacc306-aeda-4428-ba21-e1bf7336f24e&quot;,&quot;931b4746-c341-4bcb-8060-5d22f1141b17&quot;,&quot;1d240302-7d62-4dc2-bd8b-9cb47964ba5d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1532,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;558b7b3e-e6e8-4bcc-9a7c-c04b4c8fed70&quot;,&quot;title&quot;:&quot;7、获取转换后的device.json接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_get_device_json.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_get_device_json.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;获取转换后的device.json GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;7、获取转换后的device.json接口测试 获取转换后的device.json GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`getConvertDeviceJson/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.sysAdminToken)\n    //.expect(200, done);\n    .end(function (err, resp) {\n        var props = resp.body[0];\n        //console.log(props);\n        (props.client_attrib != undefined).should.be.true;\n        (props.share_attrib  != undefined).should.be.true;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;21a2ec95-8b2c-4bc5-ba4e-7eafcef64280&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;21a2ec95-8b2c-4bc5-ba4e-7eafcef64280&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:278,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4a8f4568-b305-40c5-b110-717a38f60a69&quot;,&quot;title&quot;:&quot;2、报表接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_report.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_report.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;GET 获取报表文件 错误的ID should return a 500 response&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 GET 获取报表文件 错误的ID should return a 500 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:202,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`reports/${util.unitTestParams.assetIdError}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(500, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4440d94b-d03f-4e05-b5f3-154c7d7c7eac&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET 获取报表文件 正确的ID should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 GET 获取报表文件 正确的ID should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(30000);\nutil.API.get(`reports/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        limit: 20\n    })\n    //.set(&#x27;limit&#x27;, 20)\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fad4a6e1-691c-4e96-8a66-d3d4662a973b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET 获取所有报表文件  reports/ALL&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 GET 获取所有报表文件  reports/ALL&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:208,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(20000);\nutil.API.get(`reports/ALL`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        limit: 200\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;aaaa03da-9696-4e7b-9cd9-153441e442ee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;生成报表文件前获取模板文件 GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 生成报表文件前获取模板文件 GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:208,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`templates/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(200)\n    .end(function(err, resp){\n        done();\n        tmplateFileId = resp.body[0].fileId;\n        //console.log(resp.body);\n        //console.log(tmplateFileId);\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;050d7b78-9b22-439e-a77c-c41221e51754&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;POST 生成报表文件 should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 POST 生成报表文件 should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\n//console.log(`post use: ${tmplateFileId}`);\nutil.API.post(`reports/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .send({\n        fileId: tmplateFileId,\n        report_name:\&quot;UnitTestReport\&quot;,\n        report_type:\&quot;DAY\&quot;,\n        operator:\&quot;柳强东\&quot;,\n        startTime:\&quot;1551369600000\&quot;,\n        endTime:\&quot;1556640000000\&quot;\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a48ddc8a-9607-4e53-a31b-ca47d72d4aff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;POST 手动上传报表文件 should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 POST 手动上传报表文件 should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1163,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(50000);\nutil.API.post(`reports/upload/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .field(&#x27;report_name&#x27;, manualUploadReportName)\n    .field(&#x27;report_type&#x27;, &#x27;DAY&#x27;)\n    .field(&#x27;operator&#x27;, &#x27;柳强东&#x27;)\n    .attach(&#x27;report_file&#x27;, &#x27;20190508.docx&#x27;)\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;51b4066c-5b1b-440b-b511-5485bef7516d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET 删除报表前获取数据  reports/ALL&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 GET 删除报表前获取数据  reports/ALL&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:249,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(20000);\nutil.API.get(`reports/ALL`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        limit: 200\n    })\n    //.set(&#x27;limit&#x27;, 20)\n    .end(function (err, resp) {\n        done();\n        var reports = resp.body.data;\n        console.log(reports.length);\n        var find = false;\n        for (var i = 0; i &lt; reports.length; i++) {\n            let _dt = reports[i];\n            if (_dt.report_name === manualUploadReportName) {\n                find = true;\n                deleteParams.assetId   = _dt.assetId;\n                deleteParams.report_id = _dt.report_id;\n                deleteParams.report_fileId = _dt.report_fileId;\n                break;\n            }\n        }\n        \n        util.expect(find).to.be.equal(true);\n    });\n    //.expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;264a9051-e7dc-458c-93a3-8499ff733661&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DELETE 删除报表&quot;,&quot;fullTitle&quot;:&quot;2、报表接口测试 DELETE 删除报表&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:399,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//console.log(`delete params: ${deleteParams.assetId} ${deleteParams.report_id} ${deleteParams.report_fileId}`);\nthis.timeout(20000);\n// 临时屏蔽\nutil.API.delete(`reports/${deleteParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        reportId: deleteParams.report_id,\n        fileId: deleteParams.report_fileId\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;63966179-55e9-4c7c-abe6-2b2b1c6f63bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4440d94b-d03f-4e05-b5f3-154c7d7c7eac&quot;,&quot;fad4a6e1-691c-4e96-8a66-d3d4662a973b&quot;,&quot;aaaa03da-9696-4e7b-9cd9-153441e442ee&quot;,&quot;050d7b78-9b22-439e-a77c-c41221e51754&quot;,&quot;a48ddc8a-9607-4e53-a31b-ca47d72d4aff&quot;,&quot;51b4066c-5b1b-440b-b511-5485bef7516d&quot;,&quot;264a9051-e7dc-458c-93a3-8499ff733661&quot;,&quot;63966179-55e9-4c7c-abe6-2b2b1c6f63bb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3870,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b8bc7ede-ab79-4105-aa19-21ad85162a44&quot;,&quot;title&quot;:&quot;6、统计接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_statistics.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_statistics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;获取物理量count信息 GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;6、统计接口测试 获取物理量count信息 GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:467,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`statistics/${testParams.deviceId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        keys: testParams.keys,\n        startTime: testParams.startTime,\n        endTime: testParams.endTime\n    })\n    //.expect(200, done);\n    .end(function (err, resp) {\n        var cntInfo = resp.body[0];\n        //console.log(cntInfo);\n        util.expect(cntInfo.key).to.be.equal(testParams.keys);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8f82d66c-174e-4b32-a33a-bd691a5e2a4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;获取物理量count信息 GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;6、统计接口测试 获取物理量count信息 GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:458,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`statistics/${testParams.deviceId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        keys: testParams.keys + &#x27;ERROR&#x27;,\n        startTime: testParams.startTime,\n        endTime: testParams.endTime\n    })\n    //.expect(200, done);\n    .end(function (err, resp) {\n        var cntInfo = resp.body[0];\n        util.expect(cntInfo).to.be.equal(undefined);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;928d697e-4477-4b2e-80fb-5378ea36e16b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f82d66c-174e-4b32-a33a-bd691a5e2a4a&quot;,&quot;928d697e-4477-4b2e-80fb-5378ea36e16b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:925,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f6eb7e54-aa21-4a57-9fa7-1ca6c19e3f84&quot;,&quot;title&quot;:&quot;1、模板接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_template.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_template.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;GET should return a 500 response&quot;,&quot;fullTitle&quot;:&quot;1、模板接口测试 GET should return a 500 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:193,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`templates/${util.unitTestParams.assetIdError}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(500, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fb0ebcf3-1eac-4d14-9fab-3442e2fe3073&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;1、模板接口测试 GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:198,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`templates/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;30cced9c-b0ba-4d34-bb4c-7420474933ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GET 删除模板前获取数据&quot;,&quot;fullTitle&quot;:&quot;1、模板接口测试 GET 删除模板前获取数据&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`templates/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        limit: 200\n    })\n    .end(function (err, resp) {\n        done();\n        var reports = resp.body;\n        console.log(reports.length);\n        if (reports.length &gt; 0) {\n            let _dt = reports[reports.length - 1];\n            deleteParams.assetId   = util.unitTestParams.assetId;\n            deleteParams.template_name = _dt.template_name;\n            //console.log(`delete params: ${deleteParams.assetId} ${deleteParams.report_id} ${deleteParams.report_fileId}`);\n        }\n    });\n    //.expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e9bd2990-970b-4769-baf9-487f2c1470cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DELETE 删除模板&quot;,&quot;fullTitle&quot;:&quot;1、模板接口测试 DELETE 删除模板&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:925,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;console.log(`delete params: ${deleteParams.assetId} ${deleteParams.template_name}`);\n//this.timeout(20000);\n// 临时屏蔽\nutil.API.delete(`templates/${deleteParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        templateName : &#x27;UnitTestTemplate&#x27;\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;658b143d-7fcd-4834-989f-c82637e53657&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;POST 上传模板&quot;,&quot;fullTitle&quot;:&quot;1、模板接口测试 POST 上传模板&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1510,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;console.log(\&quot;start up 模板\&quot;);\nthis.timeout(50000);\nutil.API.post(`templates/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .set(&#x27;Content-Type&#x27;, &#x27;multipart/form-data&#x27;)\n    .field(&#x27;template_name&#x27;, &#x27;UnitTestTemplate&#x27;)\n    .attach(&#x27;template_file&#x27;, &#x27;20190508.docx&#x27;)\n    .end(function (err, resp) {\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6f6a00e2-6127-41c0-b740-9ee2593cf59f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fb0ebcf3-1eac-4d14-9fab-3442e2fe3073&quot;,&quot;30cced9c-b0ba-4d34-bb4c-7420474933ea&quot;,&quot;e9bd2990-970b-4769-baf9-487f2c1470cf&quot;,&quot;658b143d-7fcd-4834-989f-c82637e53657&quot;,&quot;6f6a00e2-6127-41c0-b740-9ee2593cf59f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3037,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;85704789-7143-40c6-a8a4-825feb2a08f2&quot;,&quot;title&quot;:&quot;5、视频墙接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_videoWall.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_videoWall.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;获取视频墙信息 GET should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;5、视频墙接口测试 获取视频墙信息 GET should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:201,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`currentUser/wallResult/`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    //.expect(200, done);\n    .end(function (err, resp) {\n        var videoInfo = resp.body.videoInfo;\n        //console.log(videoInfo);\n        util.expect(videoInfo).to.be.equal(&#x27;UnitTestVideoInfo&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0143b204-a8ef-42dd-9303-8211a67d6423&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;设置视频墙信息 POST should return a 200 response&quot;,&quot;fullTitle&quot;:&quot;5、视频墙接口测试 设置视频墙信息 POST should return a 200 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:192,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.post(`currentUser/wallResult/`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        videoInfo: \&quot;UnitTestVideoInfo\&quot;\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;370e8c01-0e1f-4114-85b9-2d37d2a14f08&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0143b204-a8ef-42dd-9303-8211a67d6423&quot;,&quot;370e8c01-0e1f-4114-85b9-2d37d2a14f08&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:393,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;08ec9afc-5b4c-48ab-9310-3e2d59420587&quot;,&quot;title&quot;:&quot;4、预警接口测试&quot;,&quot;fullFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\test\\unit_test_warnings.js&quot;,&quot;file&quot;:&quot;\\test\\unit_test_warnings.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return a 500 response&quot;,&quot;fullTitle&quot;:&quot;4、预警接口测试 should return a 500 response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:205,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// this.timeout(20000);\nutil.API.get(`warnings/${util.unitTestParams.assetIdError}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .expect(500, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;076cf918-97d0-4f06-a4ea-86aaf4ba8fd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;设置资产预警状态 POST should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;4、预警接口测试 设置资产预警状态 POST should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.post(`warnings/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .query({\n        asset_warning_level: &#x27;BLUE&#x27;\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f76f221a-6893-41c9-b585-8cff3ed7a1e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;获取资产预警状态 GET  should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;4、预警接口测试 获取资产预警状态 GET  should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`warnings/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    //.expect(200, done);\n    .end(function (err, resp) {\n        done();\n        //console.info(resp.body.asset_warning_level);\n        var level = resp.body.asset_warning_level;\n        util.expect(level).to.be.equal(&#x27;BLUE&#x27;);\n    })&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;79678467-36c9-4d25-ad37-c5693aa7ba9c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;设置资产预警规则 POST should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;4、预警接口测试 设置资产预警规则 POST should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1072,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.post(`rules/warnings/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    .send({\n        \&quot;blueRules\&quot;: [\n            {\n                \&quot;andRule\&quot;: [\n                    \&quot;123456\&quot;\n                ]\n            }\n        ],\n        \&quot;orangeRules\&quot;: [\n            {\n                \&quot;andRule\&quot;: [\n                    \&quot;654321\&quot;\n                ]\n            }\n        ]\n    })\n    .expect(200, done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;212ee53f-bda4-4bb3-84ed-883bb8d8a77a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;获取资产预警规则 GET  should return a 200 response&#x27;&quot;,&quot;fullTitle&quot;:&quot;4、预警接口测试 获取资产预警规则 GET  should return a 200 response&#x27;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:410,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//this.timeout(20000);\nutil.API.get(`rules/warnings/${util.unitTestParams.assetId}`)\n    .set(&#x27;Accept&#x27;, &#x27;application/json&#x27;)\n    .set(&#x27;X-Authorization&#x27;, util.unitTestParams.token)\n    //.expect(200, done);\n    .end(function (err, resp) {\n        done();\n        //console.info(resp.body.blueRules);\n        //console.info(resp.body.orangeRules);\n        var blueRules = resp.body.blueRules[0];\n        var orangeRules = resp.body.orangeRules[0];\n        //var level = resp.body.asset_warning_level;      \n        util.expect(blueRules.andRule[0]).to.be.equal(&#x27;123456&#x27;);\n        util.expect(orangeRules.andRule[0]).to.be.equal(&#x27;654321&#x27;);\n    })&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e12534bd-405b-4a9e-a3a5-6410a01dad76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;076cf918-97d0-4f06-a4ea-86aaf4ba8fd7&quot;,&quot;f76f221a-6893-41c9-b585-8cff3ed7a1e9&quot;,&quot;79678467-36c9-4d25-ad37-c5693aa7ba9c&quot;,&quot;212ee53f-bda4-4bb3-84ed-883bb8d8a77a&quot;,&quot;e12534bd-405b-4a9e-a3a5-6410a01dad76&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3113,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000},&quot;copyrightYear&quot;:2019}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;apiGateway&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\mochawesome-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;D:\\Project\\nodeJS\\iovVis\\apiGateway\\mochawesome-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>